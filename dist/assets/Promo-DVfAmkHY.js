import{a as h,b as g,r as d,j as e,M as V,G as u,g as _,P as q,I as B,B as E,c as b,d as j}from"./index-So8Y0uMi.js";import{h as S}from"./moment-G82_0lEo.js";import{d as K}from"./Add-CKqOdQJH.js";import{T as Q,a as X,b as Z,c as w,d as k,e as ee}from"./TableRow-ByAOLB1Q.js";import{E as re}from"./Edit-dsByrqxG.js";import{D as oe}from"./DeleteForever-Db3yxdnW.js";import{T as te}from"./TablePagination-Bq1iu1it.js";import{D as ae,a as se}from"./DialogTitle-B--fWyEw.js";import{D as ne}from"./DialogActions-Bk10_EIe.js";import"./LastPage-C7laYLYy.js";import"./MenuItem-CSdFaWhF.js";const ie=async(a,s)=>{try{await h({method:"POST",url:`${g}/promo/v1/createPromo`,headers:s,data:JSON.stringify(a)}).then(function(o){console.log(o),o.data.responseCode===201?alert("Promo  added successfully"):alert(o)})}catch(o){alert(o)}},de=async a=>{try{return(await h.get(`${g}/promo/v1/getAllPromoByPagination/{pageNumber}/{pageSize}?pageNumber=0&pageSize=10`,{headers:a})).data}catch(s){throw s}},le=async(a,s)=>await h({method:"GET",url:`${g}/promo/v1/getPromoByPromoId/{promoId}?promoId=${s}`,headers:a}),ce=async(a,s)=>{try{const o=await h({method:"PUT",url:`${g}/promo/v1/updatePromo`,headers:s,data:a});o.data.responseCode===201?alert(o.data.message):o.data.responseCode===400?alert(o.data.errorMessage):alert("Unexpected response code")}catch(o){console.error("Error updating promo:",o)}},me=async(a,s)=>{await h({method:"DELETE",url:`${g}/promo/v1/deletePromoById/${s}`,headers:a}).then(o=>{o.data.responseCode===200?alert(o.data.message):o.data.responseCode===400&&alert(o.data.errorMessage)}).catch(o=>{console.log(o)})},R=[{id:"promoId",label:"ID"},{id:"promoName",label:"Name",minWidth:100},{id:"description",label:"Description",minWidth:100},{id:"youTube",label:"Youtube"},{id:"createdBy",label:"Created By",align:"right"},{id:"updatedBy",label:"Updated By",align:"right"},{id:"insertedDate",label:"Inserted Date",align:"right"},{id:"updatedDate",label:"Updated Date",align:"right"},{id:"actions",label:"Actions",align:"right"}],De=()=>{const[a,s]=d.useState(0),[o,U]=d.useState(10),[P,T]=d.useState([]),[W,m]=d.useState(!1),[D,I]=d.useState(!1),[c,N]=d.useState({}),[A,$]=d.useState(null),C=d.useRef(null),[z,M]=d.useState(!1),[i,f]=d.useState({promoName:"",description:"",youTube:""}),O=(r,t)=>{s(t)},L=r=>{U(+r.target.value),s(0)},x=JSON.parse(sessionStorage.getItem("user")),p={"Content-type":"application/json",Authorization:"Bearer "+x.accessToken},y=r=>{f({...i,[r.target.name]:r.target.value}),N({...c,[r.target.name]:null})},F=()=>{const r={};return(!i.promoName||i.promoName.trim()==="")&&(r.promoName="Enter the Advertisement name"),(!i.description||i.description.trim()==="")&&(r.description="Enter the description"),(!i.youTube||i.youTube.trim()==="")&&(r.youTube="Enter Youtube URL"),r},v=async()=>{try{const t=(await de(p)).content;if(t){const n=t.map(l=>({promoId:l.promoId,promoName:l.promoName,description:l.description,youTube:l.youTube,insertedDate:S(l.insertedDate).format("L"),updatedDate:S(l.updatedDate).format("L"),createdBy:l.createdBy?l.createdBy.userName:"No User",updatedBy:l.updatedBy?l.updatedBy.userName:"No User"}));T(n)}else T([])}catch(r){console.error("Error fetching promo data:",r)}};d.useEffect(()=>{v()},[z]);const H=async r=>{await me(p,r),v()},G=async r=>{I(!0),m(!0);try{const n=(await le(p,r)).data;n?($(n.promoId),f({promoName:n.promoName,description:n.description,youTube:n.youTube})):console.error("No promo data found for id:",r)}catch(t){console.error("Error fetching promo details:",t)}},Y=()=>{I(!1),f({promoName:"",description:"",youTube:""}),m(!0)},J=async r=>{r.preventDefault();const t=F();if(Object.keys(t).length>0)N(t);else try{if(D){const n={...i,promoId:A,updatedBy:{userId:x.userId}};await ce(n,p)}else await ie({...i,createdBy:{userId:x.userId}},p);f({promoName:"",description:"",youTube:""}),C.current.value=null,M(n=>!n),m(!1)}catch(n){console.error("Error saving promo:",n)}};return e.jsxs(V,{title:e.jsxs(E,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Promo"}),e.jsxs(j,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px"},onClick:Y,children:["Add",e.jsx(K,{sx:{color:"#fff"}})]})]}),children:[e.jsx(u,{container:!0,spacing:_}),e.jsxs(q,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(Q,{sx:{maxHeight:440},children:e.jsxs(X,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(Z,{children:e.jsx(w,{children:R.map(r=>e.jsx(k,{align:r.align,style:{minWidth:r.minWidth,fontWeight:600,fontSize:15},children:r.label},r.id))})}),e.jsx(ee,{children:P.slice(a*o,a*o+o).map(r=>e.jsx(w,{hover:!0,role:"checkbox",tabIndex:-1,children:R.map(t=>e.jsx(k,{align:t.align,children:t.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(B,{onClick:()=>G(r.promoId),color:"primary",children:e.jsx(re,{})}),e.jsx(B,{onClick:()=>H(r.promoId),color:"error",children:e.jsx(oe,{})})]}):r[t.id]},t.id))},r.promoId))})]})}),e.jsx(te,{rowsPerPageOptions:[10,25,100],component:"div",count:P.length,rowsPerPage:o,page:a,onPageChange:O,onRowsPerPageChange:L})]}),e.jsxs(ae,{open:W,onClose:()=>m(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(se,{sx:{fontSize:"16px"},children:D?"Edit Promo":"Add Promo"}),e.jsxs(E,{component:"form",onSubmit:J,noValidate:!0,sx:{p:3},children:[e.jsxs(u,{container:!0,spacing:2,children:[e.jsx(u,{item:!0,xs:12,children:e.jsx(b,{fullWidth:!0,label:"Promo Name",name:"promoName",value:i.promoName,onChange:y,error:!!c.promoName,helperText:c.promoName})}),e.jsx(u,{item:!0,xs:12,children:e.jsx(b,{fullWidth:!0,label:"Description",name:"description",value:i.description,onChange:y,error:!!c.description,helperText:c.description})}),e.jsx(u,{item:!0,xs:12,children:e.jsx(b,{fullWidth:!0,label:"YouTube URL",name:"youTube",value:i.youTube,onChange:y,error:!!c.youTube,helperText:c.youTube,inputRef:C})})]}),e.jsxs(ne,{sx:{pt:3},children:[e.jsx(j,{onClick:()=>m(!1),children:"Cancel"}),e.jsx(j,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})]})]})]})};export{De as default};
