import{i as O,f as A,j as e,U as F,r as s,B as v,P as G,T as r,G as n,D as U,F as j,h as g,S as b,d as w,az as a}from"./index-So8Y0uMi.js";import{d as V}from"./PlayArrow-fFRiTYJQ.js";import{f as J,g as Y,a as $,b as K}from"./MCATestApi-Ckt43_fe.js";import{M as l}from"./MenuItem-CSdFaWhF.js";var I={},X=O;Object.defineProperty(I,"__esModule",{value:!0});var M=I.default=void 0,Z=X(A()),ee=e;M=I.default=(0,Z.default)((0,ee.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}),"History");const ae=()=>{const y=F(),[C,W]=s.useState(!0),[S,q]=s.useState([]),[u,N]=s.useState([]),[x,R]=s.useState([]),[p,D]=s.useState(""),[c,B]=s.useState(""),[o,_]=s.useState(""),[E,T]=s.useState(!1),h=s.useRef(Date.now()),z=s.useRef(null),P="MCQ Test Assessment",L=20,f="TEST",Q=20,d={"Content-type":"application/json",Authorization:"Bearer "+JSON.parse(sessionStorage.getItem("user")).accessToken};s.useEffect(()=>{const t=new BroadcastChannel("exam_channel");return z.current=t,t.postMessage({type:"check",tabId:h.current}),t.onmessage=m=>{const{type:i,tabId:H}=m.data;i==="check"?t.postMessage({type:"active",tabId:h.current}):i==="active"&&H!==h.current&&W(!1)},()=>{t.close()}},[]),s.useEffect(()=>{J(d).then(t=>{q((t==null?void 0:t.content)||[])}).catch(t=>{console.error("Error fetching topics:",t)})},[]),s.useEffect(()=>{Y(d).then(t=>{N(t||[])}).catch(t=>{console.error("Error fetching expertise levels:",t)})},[]),s.useEffect(()=>{$(d).then(t=>{R(t||[])}).catch(t=>{console.error("Error fetching experience levels:",t)})},[]);const k=async()=>{if(!C){a.fire("Multiple Tabs","Please close other tabs to proceed.","warning");return}if(!p){a.fire("Incomplete","Please select a topic","warning");return}if(!c){a.fire("Incomplete","Please select expertise level","warning");return}if(!o){a.fire("Incomplete","Please select experience level","warning");return}const t=S.find(i=>i.topicId===p);if(!t){a.fire("Error","Invalid topic selected","error");return}T(!0);const m={experienceId:parseInt(o),expertiseLevelId:parseInt(c),mcqTopicDTOList:[{topicId:t.topicId,topicName:t.topicName}],mode:f,numberOfQuestions:L};try{const i=await K(m,d);i&&i.length>0?y("/jobs/exam",{state:{mcqData:i,selectedTopic:t,selectedMode:f,expertiseLevelId:c,experienceId:o}}):a.fire("No Questions","No MCQs available for selected filters.","info")}catch(i){console.error("MCQ fetch error:",i),a.fire("Error","Something went wrong while fetching questions.","error")}finally{T(!1)}};return e.jsx(v,{sx:{bgcolor:"#f0f4f8",py:5,px:2,minHeight:"82%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsxs(G,{elevation:6,sx:{maxWidth:960,width:"100%",borderRadius:3,p:4},children:[e.jsx(r,{variant:"h4",fontWeight:600,color:"primary.main",mb:2,children:P}),e.jsxs(n,{container:!0,spacing:2,mb:3,children:[e.jsxs(n,{item:!0,xs:6,sm:3,children:[e.jsx(r,{variant:"subtitle2",children:"Total Questions"}),e.jsx(r,{variant:"body1",children:L})]}),e.jsxs(n,{item:!0,xs:6,sm:3,children:[e.jsx(r,{variant:"subtitle2",children:"Duration"}),e.jsxs(r,{variant:"body1",children:[Q," Minutes"]})]}),e.jsxs(n,{item:!0,xs:6,sm:3,children:[e.jsx(r,{variant:"subtitle2",children:"Sections"}),e.jsx(r,{variant:"body1",children:"3"})]}),e.jsxs(n,{item:!0,xs:6,sm:3,children:[e.jsx(r,{variant:"subtitle2",children:"Mode"}),e.jsx(r,{variant:"body1",color:"primary",children:f})]})]}),e.jsx(U,{sx:{mb:3}}),e.jsx(r,{variant:"h5",fontWeight:600,gutterBottom:!0,children:"Instructions"}),e.jsxs(v,{component:"ul",sx:{pl:3,mb:3},children:[e.jsx("li",{children:e.jsx(r,{children:"Timed test â€“ auto-submits when time ends."})}),e.jsx("li",{children:e.jsx(r,{children:"Unattempted questions do not have negative marking."})}),e.jsx("li",{children:e.jsx(r,{children:"You can submit early to view results immediately."})}),e.jsx("li",{children:e.jsx(r,{children:"Review answers with correct solutions after submission."})})]}),e.jsxs(v,{sx:{mb:4,display:"flex",gap:3,flexWrap:"wrap"},children:[e.jsxs(j,{fullWidth:!0,sx:{minWidth:200,flex:1},children:[e.jsx(g,{children:"Select Topic"}),e.jsx(b,{value:p,label:"Select Topic",onChange:t=>D(t.target.value),children:S.map(t=>e.jsx(l,{value:t.topicId,children:t.topicName},t.topicId))})]}),e.jsxs(j,{fullWidth:!0,sx:{minWidth:200,flex:1},children:[e.jsx(g,{children:"Expertise Level"}),e.jsx(b,{value:c,onChange:t=>B(t.target.value),label:"Expertise Level",disabled:u.length===0,children:u.length===0?e.jsx(l,{disabled:!0,children:"Loading expertise levels..."}):u.map(t=>e.jsx(l,{value:t.expertiseLevelId,children:t.levelName},t.expertiseLevelId))})]}),e.jsxs(j,{fullWidth:!0,sx:{minWidth:200,flex:1},children:[e.jsx(g,{children:"Experience"}),e.jsx(b,{value:o,onChange:t=>_(t.target.value),label:"Experience",disabled:x.length===0,children:x.length===0?e.jsx(l,{disabled:!0,children:"Loading experience levels..."}):x.map(t=>e.jsx(l,{value:t.experienceId,children:t.experienceName||t.levelName||t.name},t.experienceId))})]})]}),e.jsxs(n,{container:!0,spacing:2,justifyContent:"center",children:[e.jsx(n,{item:!0,children:e.jsx(w,{variant:"contained",color:"primary",size:"large",endIcon:e.jsx(V,{}),onClick:k,disabled:E,sx:{px:4,py:1.5,fontSize:"16px",fontWeight:500},children:E?"Loading...":"Start Test"})}),e.jsx(n,{item:!0,children:e.jsx(w,{variant:"outlined",color:"primary",size:"large",endIcon:e.jsx(M,{}),onClick:()=>y("/jobs/examhistory"),sx:{px:4,py:1.5,fontSize:"16px",fontWeight:500},children:"View Test History"})})]})]})})};export{ae as default};
