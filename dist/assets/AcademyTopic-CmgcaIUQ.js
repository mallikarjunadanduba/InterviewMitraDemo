import{u as J,r as s,j as e,M as _,G as d,g as q,P as K,I as D,B as I,c as h,F as Q,h as X,S as Y,k as Z,d as p}from"./index-So8Y0uMi.js";import{d as $}from"./Add-CKqOdQJH.js";import{h as T}from"./moment-G82_0lEo.js";import{d as ee,c as te}from"./AcademyCategoryApi-BCSkgFb2.js";import{T as ae,a as re,b as oe,c as S,d as U,e as se}from"./TableRow-ByAOLB1Q.js";import{E as ie}from"./Edit-dsByrqxG.js";import{D as de}from"./DeleteForever-Db3yxdnW.js";import{T as le}from"./TablePagination-Bq1iu1it.js";import{D as ne,a as ce}from"./DialogTitle-B--fWyEw.js";import{M as C}from"./MenuItem-CSdFaWhF.js";import{D as me}from"./DialogActions-Bk10_EIe.js";import"./LastPage-C7laYLYy.js";const B=[{id:"topicId",label:"ID"},{id:"topicName",label:"Name",minWidth:100},{id:"description",label:"Description",minWidth:100},{id:"moduleName",label:"Module",minWidth:150},{id:"videoUrl",label:"VideoUrl"},{id:"createdBy",label:"Created By",align:"right"},{id:"updatedBy",label:"Updated By",align:"right"},{id:"insertedDate",label:"Inserted Date",align:"right"},{id:"updatedDate",label:"Updated Date",align:"right"},{id:"actions",label:"Actions",align:"right"}],Te=()=>{J();const[u,x]=s.useState(0),[l,P]=s.useState(10),[g,f]=s.useState([]),[E,M]=s.useState([]),[w,n]=s.useState(!1),[W,k]=s.useState(!1),[o,j]=s.useState({topicName:"",description:"",moduleId:"",videoUrl:""}),[i,b]=s.useState({}),[v,A]=s.useState(!1),F=(t,r)=>{x(r)},R=t=>{P(+t.target.value),x(0)},N={"Content-type":"application/json",Authorization:"Bearer "+JSON.parse(sessionStorage.getItem("user")).accessToken},H=async()=>{try{const r=(await ee(N)).data.content;if(console.log(r),r){const y=r.map(a=>({topicId:a.topicId,topicName:a.topicName,description:a.description,moduleName:a.academicModuleDtoList?a.academicModuleDtoList.moduleName:"No Module Name",videoUrl:a.videoUrl,insertedDate:T(a.insertedDate).format("L"),updatedDate:T(a.updatedDate).format("L"),createdBy:a.createdBy?a.createdBy.userName:"No User",updatedBy:a.updatedBy?a.updatedBy.userName:"No User"}));f(y)}else f([])}catch(t){console.error("Error fetching topics:",t)}},L=async()=>{try{const r=(await te(N)).data.content;if(r){const a=r.sort((m,G)=>m.moduleName.localeCompare(G.moduleName)).map(m=>({moduleId:m.moduleId,moduleName:m.moduleName}));M(a)}}catch(t){console.error("Error fetching modules:",t)}};s.useEffect(()=>{H(),L()},[v]);const z=()=>{const t={};return(!o.topicName||o.topicName.trim()==="")&&(t.topicName="Enter the topic name"),(!o.description||o.description.trim()==="")&&(t.description="Enter the description"),(!o.videoUrl||o.videoUrl.trim()==="")&&(t.videoUrl="Enter the videoUrl"),o.moduleId||(t.moduleId="Select a module"),t},c=t=>{j({...o,[t.target.name]:t.target.value}),b({...i,[t.target.name]:null})},O=()=>{k(!1),j({topicName:"",description:"",moduleId:"",videoUrl:""}),n(!0)},V=()=>{const t=z();Object.keys(t).length===0?(n(!1),A(!v)):b(t)};return e.jsxs(_,{title:e.jsxs(I,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Academy Topics"}),e.jsxs(p,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px"},onClick:O,children:["Add",e.jsx($,{sx:{color:"#fff"}})]})]}),children:[e.jsx(d,{container:!0,spacing:q}),e.jsxs(K,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(ae,{sx:{maxHeight:440},children:e.jsxs(re,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(oe,{children:e.jsx(S,{children:B.map(t=>e.jsx(U,{align:t.align,style:{minWidth:t.minWidth,fontWeight:600,fontSize:15},children:t.label},t.id))})}),e.jsx(se,{children:g.slice(u*l,u*l+l).map(t=>e.jsx(S,{hover:!0,role:"checkbox",tabIndex:-1,children:B.map(r=>e.jsx(U,{align:r.align,children:r.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(D,{color:"primary",children:e.jsx(ie,{})}),e.jsx(D,{color:"error",children:e.jsx(de,{})})]}):t[r.id]||"No Data"},r.id))},t.topicId))})]})}),e.jsx(le,{rowsPerPageOptions:[10,25,100],component:"div",count:g.length,rowsPerPage:l,page:u,onPageChange:F,onRowsPerPageChange:R})]}),e.jsxs(ne,{open:w,onClose:()=>n(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(ce,{sx:{fontSize:"16px"},children:W?"Edit Topic":"Add Topic"}),e.jsxs(I,{component:"form",noValidate:!0,sx:{p:3},onSubmit:t=>{t.preventDefault(),V()},children:[e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,children:e.jsx(h,{fullWidth:!0,label:"Topic Name",name:"topicName",value:o.topicName,onChange:c,error:!!i.topicName,helperText:i.topicName})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(h,{fullWidth:!0,label:"Description",name:"description",value:o.description,onChange:c,error:!!i.description,helperText:i.description,multiline:!0,rows:3})}),e.jsx(d,{item:!0,xs:12,children:e.jsxs(Q,{fullWidth:!0,error:!!i.moduleId,children:[e.jsx(X,{id:"module-select",children:"Module"}),e.jsxs(Y,{labelId:"module-select",name:"moduleId",value:o.moduleId,onChange:c,children:[e.jsx(C,{value:"",children:e.jsx("em",{children:"None"})}),E.map(t=>e.jsx(C,{value:t.moduleId,children:t.moduleName},t.moduleId))]}),e.jsx(Z,{children:i.moduleId})]})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(h,{fullWidth:!0,label:"VideoUrl ",name:"videoUrl",value:o.videoUrl,onChange:c,error:!!i.videoUrl,helperText:i.videoUrl})})]}),e.jsxs(me,{children:[e.jsx(p,{onClick:()=>n(!1),children:"Cancel"}),e.jsx(p,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})]})]})]})};export{Te as default};
