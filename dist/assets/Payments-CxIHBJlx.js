import{A as S,r as d,u as B,C as O,j as e,M as x,B as n,T as s,d as M,D as R,G as c,E as h,H as m,J as g,K as f,P as G,L as H}from"./index-So8Y0uMi.js";import{g as U}from"./MyCourseApi-rra_8jT7.js";import{C as W}from"./CircularProgress-BC4NDxhn.js";import{A as F}from"./Alert-BEz85bAA.js";import{I as $}from"./IconClock-CFaAAo0_.js";import{T as J,a as X,b as K,c as b,d as a,e as Q}from"./TableRow-ByAOLB1Q.js";import{I as Y}from"./IconCalendar-BKGdsbQF.js";var C=S("circle-check","IconCircleCheck",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M9 12l2 2l4 -4",key:"svg-1"}]]),q=S("circle-x","IconCircleX",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M10 10l4 4m0 -4l-4 4",key:"svg-1"}]]);const ne=()=>{const[o,v]=d.useState([]),[I,u]=d.useState(!0),[j,p]=d.useState(null),t=B();O(t.breakpoints.down("sm"));const l=JSON.parse(sessionStorage.getItem("user")),k={"Content-type":"application/json",Authorization:"Bearer "+l.accessToken},y=async()=>{try{u(!0),p(null);const z=(await U(k,l.seekerId)).data.sort((N,L)=>new Date(L.createdAt)-new Date(N.createdAt));v(z)}catch(r){console.error("Error fetching payment history:",r),p("Failed to load payment history. Please try again.")}finally{u(!1)}};d.useEffect(()=>{l&&l.seekerId?y():(p("User not found. Please login again."),u(!1))},[]);const w=r=>{switch(r){case"SUCCESS":return"success";case"PENDING":return"warning";case"FAILED":return"error";default:return"default"}},P=r=>{switch(r){case"SUCCESS":return e.jsx(C,{size:16});case"FAILED":return e.jsx(q,{size:16});default:return e.jsx(f,{size:16})}},T=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",A=()=>o.filter(r=>r.paymentStatus==="SUCCESS").reduce((r,i)=>r+i.amountPaid,0),E=()=>o.filter(r=>r.paymentStatus==="SUCCESS").length,D=()=>o.filter(r=>r.paymentStatus==="PENDING").length;return I?e.jsx(x,{children:e.jsxs(n,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:[e.jsx(W,{}),e.jsx(s,{variant:"h6",sx:{ml:2},children:"Loading payment history..."})]})}):j?e.jsxs(x,{children:[e.jsx(F,{severity:"error",sx:{mb:2},children:j}),e.jsx(M,{variant:"contained",onClick:y,children:"Retry"})]}):e.jsx(e.Fragment,{children:e.jsxs(x,{children:[e.jsx(s,{variant:"h3",gutterBottom:!0,sx:{mb:3},children:"Payment History"}),e.jsx(R,{sx:{mb:3}}),e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsx(h,{sx:{backgroundColor:t.palette.background.paper,borderLeft:`6px solid ${t.palette.success.main}`,boxShadow:1,transition:"transform 0.2s ease-in-out","&:hover":{transform:"scale(1.02)"}},children:e.jsx(m,{children:e.jsxs(n,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(C,{size:24,color:t.palette.success.main}),e.jsxs(n,{children:[e.jsx(s,{variant:"h4",sx:{fontWeight:"bold",color:t.palette.success.main},children:E()}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Successful Payments"})]})]})})})}),e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsx(h,{sx:{backgroundColor:t.palette.background.paper,borderLeft:`6px solid ${t.palette.warning.main}`,boxShadow:1,transition:"transform 0.2s ease-in-out","&:hover":{transform:"scale(1.02)"}},children:e.jsx(m,{children:e.jsxs(n,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(g,{size:24,color:t.palette.warning.main}),e.jsxs(n,{children:[e.jsxs(s,{variant:"h4",sx:{fontWeight:"bold",color:t.palette.warning.main},children:["â‚¹",A()]}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Total Spent"})]})]})})})}),e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsx(h,{sx:{backgroundColor:t.palette.background.paper,borderLeft:`6px solid ${t.palette.primary.main}`,boxShadow:1,transition:"transform 0.2s ease-in-out","&:hover":{transform:"scale(1.02)"}},children:e.jsx(m,{children:e.jsxs(n,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(f,{size:24,color:t.palette.primary.main}),e.jsxs(n,{children:[e.jsx(s,{variant:"h4",sx:{fontWeight:"bold",color:t.palette.primary.main},children:o.length}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Total Transactions"})]})]})})})}),e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsx(h,{sx:{backgroundColor:t.palette.background.paper,borderLeft:`6px solid ${t.palette.info.main}`,boxShadow:1,transition:"transform 0.2s ease-in-out","&:hover":{transform:"scale(1.02)"}},children:e.jsx(m,{children:e.jsxs(n,{display:"flex",alignItems:"center",gap:2,children:[e.jsx($,{size:24,color:t.palette.info.main}),e.jsxs(n,{children:[e.jsx(s,{variant:"h4",sx:{fontWeight:"bold",color:t.palette.info.main},children:D()}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Pending Payments"})]})]})})})})]}),e.jsxs(x,{children:[e.jsx(s,{variant:"h5",gutterBottom:!0,sx:{mb:3},children:"Transaction History"}),o.length===0?e.jsxs(n,{textAlign:"center",py:8,children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"No payment history found"}),e.jsx(s,{variant:"body1",color:"text.secondary",children:"Your payment transactions will appear here once you make a purchase."})]}):e.jsx(J,{component:G,sx:{boxShadow:"none",border:"1px solid #e0e0e0"},children:e.jsxs(X,{children:[e.jsx(K,{children:e.jsxs(b,{sx:{backgroundColor:"#f5f5f5"},children:[e.jsx(a,{children:e.jsx("strong",{children:"Course"})}),e.jsx(a,{children:e.jsx("strong",{children:"Amount"})}),e.jsx(a,{children:e.jsx("strong",{children:"Status"})}),e.jsx(a,{children:e.jsx("strong",{children:"Payment Gateway"})}),e.jsx(a,{children:e.jsx("strong",{children:"Date"})}),e.jsx(a,{children:e.jsx("strong",{children:"Transaction ID"})})]})}),e.jsx(Q,{children:o.map(r=>{var i;return e.jsxs(b,{hover:!0,children:[e.jsx(a,{children:e.jsx(s,{variant:"body1",sx:{fontWeight:"medium"},children:((i=r.course)==null?void 0:i.courseName)||"N/A"})}),e.jsx(a,{children:e.jsxs(n,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(g,{size:16}),e.jsx(s,{variant:"body1",sx:{fontWeight:"medium"},children:r.amountPaid})]})}),e.jsx(a,{children:e.jsx(H,{icon:P(r.paymentStatus),label:r.paymentStatus,color:w(r.paymentStatus),size:"small"})}),e.jsx(a,{children:e.jsx(s,{variant:"body2",color:"text.secondary",children:r.paymentGateway||"N/A"})}),e.jsx(a,{children:e.jsxs(n,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Y,{size:16}),e.jsx(s,{variant:"body2",children:T(r.createdAt)})]})}),e.jsx(a,{children:e.jsx(s,{variant:"body2",color:"text.secondary",sx:{fontFamily:"monospace"},children:r.transactionId||"N/A"})})]},r.orderId)})})]})})]})]})})};export{ne as default};
